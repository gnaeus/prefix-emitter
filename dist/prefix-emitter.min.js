!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.PrefixEmitter=e.PrefixEmitter||{})}(this,function(e){"use strict";function t(e,t){var n=e.indexOf(t);n>0?e.splice(n,1):0===n&&e.shift()}function n(e){if("string"!=typeof e&&"number"!=typeof e)throw new Error("Symbol not supported");return e}function r(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return function(n,r){var i=n[p];void 0===i?n[p]=i=new Array:n.hasOwnProperty(p)||(n[p]=i=i.slice()),i.push({emitter:e,args:t,key:r})}}function i(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return function(n,r){var i=n[p];void 0===i?n[p]=i=new Array:n.hasOwnProperty(p)||(n[p]=i=i.slice()),i.push({emitter:e,args:t,key:r,once:!0})}}function o(e,t){var n=e[p];void 0===n||e.hasOwnProperty(l)||(e[l]=n.map(function(t){var n=e[t.key].bind(e);return t.once?(r=t.emitter).once.apply(r,t.args.concat([n])):(i=t.emitter).on.apply(i,t.args.concat([n]));var r,i})),void 0!==t&&(e.hasOwnProperty(l)?(r=e[l]).push.apply(r,t):e[l]=t);var r}function s(e){var t=e[l];void 0!==t&&(t.forEach(function(e){e.dispose()}),delete e[l])}var h=function(){function e(){this._store=Object.create(null),this.size=0}return e.prototype.has=function(e){return void 0!==this._store[e]},e.prototype.get=function(e){return this._store[e]},e.prototype.set=function(e,t){void 0===this._store[e]&&this.size++,this._store[e]=t},e.prototype.delete=function(e){void 0!==this._store[e]&&(this.size--,delete this._store[e])},e}(),a="undefined"!=typeof Map?Map:h,d="undefined"!=typeof Symbol?Symbol:n,f=function(){function e(e,t,n){this._node=e,this._args=t,this._handler=n,this._disposed=!1}return e.prototype.dispose=function(){if(!this._disposed){if(this._disposed=!0,0===this._args.length)return void t(this._node.handlers,this._handler);for(var e=this._node,n=new Array,r=0;r<this._args.length;++r)if(n.push(e),e=e.children.get(this._args[r]),void 0===e)return;t(e.handlers,this._handler),this._cleanupTrie(n,e)}},e.prototype._cleanupTrie=function(e,t){for(var n=e.length-1;n>=0;--n){var r=e[n];if(void 0!==t.children&&0===t.children.size&&(t.children=void 0),void 0!==t.children||0!==t.handlers.length)return;r.children.delete(this._args[n]),t=r}void 0!==t.children&&0===t.children.size&&(t.children=void 0)},e}(),c=function(){function e(){this._node={handlers:new Array}}return e.prototype._on=function(e,t){for(var n=this._node,r=0;r<e.length;++r){void 0===n.children&&(n.children=new a);var i=n.children.get(e[r]);void 0===i&&(i={handlers:new Array},n.children.set(e[r],i)),n=i}return n.handlers.push(t),new f(this._node,e,t)},e.prototype.on=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=arguments.length-1;if(n<0)throw new Error("last argument is not a function");var r=e[n];if("function"!=typeof r)throw new Error("last argument is not a function");return this._on(e.slice(0,n),r)},e.prototype.once=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=arguments.length-1;if(n<0)throw new Error("last argument is not a function");var r=e[n];if("function"!=typeof r)throw new Error("last argument is not a function");var i=this._on(e.slice(0,n),function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];i.dispose(),r.apply(void 0,e)});return i},e.prototype.emit=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=this._node,r=n.handlers,i=r.length;i--;)r[i].apply(void 0,e);for(var o,s=e.length;void 0!==n.children&&s--;){if(o=e.shift(),n=n.children.get(o),void 0===n)return;for(r=n.handlers,i=r.length;i--;)r[i].apply(void 0,e)}},e}(),u=c,p=d("__prefix_emitter_handlers_"),l=d("__prefix_emitter_subscriptions_");e.Emitter=u,e.on=r,e.once=i,e.injectSubscriptions=o,e.disposeSubscriptions=s,e.PrefixEmitter=c,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=prefix-emitter.min.js.map
